/* 
 * OpenAPI spec version: 3
 * 
 * Generated by: https://github.com/openapitools/openapi-generator.git
 */

using System;
using System.Linq;
using System.Text;

using Acumatica.RESTClient.Model;

using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

namespace Acumatica.RESTClient.Client
{
    public class ApiException<T> : ApiException where T : new()
    {
        public ApiException()
        {
        }

        public ApiException(int errorCode, string message) : base(errorCode, message)
        {
        }

        public ApiException(int errorCode, string message, string errorContent = null) : base(errorCode, message, errorContent)
        {
            if (ErrorContent != null)
            {
                try
                {
                    Body = ErrorContent?.ToObject<T>();
                    ErrorBody = GetEntityBodyWithOnlyErrors(ErrorContent);
                }
                catch { }
            }
        }

        public T Body { get; }
        public JToken ErrorBody { get; }

        public override string Message
        {
            get
            {
                if (ErrorBody is null)
                    return base.Message + Environment.NewLine + typeof(T).Name;
                return MessageText + Environment.NewLine + typeof(T).Name + Environment.NewLine + ErrorBody;
            }
        }
    }

}
